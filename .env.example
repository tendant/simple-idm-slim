# Server configuration
SERVER_ADDR=0.0.0.0
SERVER_PORT=8080

# Database configuration (matches podman setup: make postgres-start)
DB_HOST=localhost
DB_PORT=25432
DB_USER=postgres
DB_PASSWORD=postgres
DB_NAME=simple_idm
DB_SSLMODE=disable

# JWT configuration (REQUIRED - generate a secure random string)
JWT_SECRET=your-secure-secret-key-at-least-32-characters-long
JWT_ISSUER=simple-idm

# Token TTL (optional, defaults shown)
ACCESS_TOKEN_TTL=15m
REFRESH_TOKEN_TTL=168h

# Google OAuth (optional - leave empty to disable)
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=
GOOGLE_REDIRECT_URI=http://localhost:8080/auth/google/callback

# SMTP Email Configuration (optional - leave empty to disable email features)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-password
SMTP_FROM=noreply@example.com
SMTP_FROM_NAME=Simple IDM

# Application
APP_BASE_URL=http://localhost:8080
SERVE_UI=true

# Verification TTL (optional, defaults shown)
EMAIL_VERIFICATION_TTL=24h
PASSWORD_RESET_TTL=1h

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================

# Rate Limiting
# Enable/disable rate limiting globally (default: true)
RATE_LIMIT_ENABLED=true

# Auth endpoints (login, register) - requests per window
RATE_LIMIT_AUTH_REQUESTS=10
RATE_LIMIT_AUTH_WINDOW=1

# Password reset endpoints - requests per window
RATE_LIMIT_RESET_REQUESTS=3
RATE_LIMIT_RESET_WINDOW=5

# Email verification endpoints - requests per window
RATE_LIMIT_VERIFY_REQUESTS=5
RATE_LIMIT_VERIFY_WINDOW=5

# Refresh token endpoint - requests per window
RATE_LIMIT_REFRESH_REQUESTS=20
RATE_LIMIT_REFRESH_WINDOW=1

# Profile endpoints (me) - requests per window
RATE_LIMIT_PROFILE_REQUESTS=30
RATE_LIMIT_PROFILE_WINDOW=1

# Password Policy
# Enforce password complexity requirements (default: no requirements for backward compatibility)
PASSWORD_MIN_LENGTH=8
PASSWORD_REQUIRE_UPPERCASE=false
PASSWORD_REQUIRE_LOWERCASE=false
PASSWORD_REQUIRE_NUMBER=false
PASSWORD_REQUIRE_SPECIAL=false

# Security Headers
# Enable OWASP-recommended security headers (default: true)
SECURITY_HEADERS_ENABLED=true
SECURITY_HEADERS_CSP=default-src 'self'
SECURITY_HEADERS_HSTS_MAX_AGE=31536000
SECURITY_HEADERS_FRAME_OPTIONS=DENY
SECURITY_HEADERS_CONTENT_TYPE_OPTIONS=nosniff
SECURITY_HEADERS_XSS_PROTECTION=1; mode=block
SECURITY_HEADERS_REFERRER_POLICY=strict-origin-when-cross-origin
SECURITY_HEADERS_PERMISSIONS_POLICY=geolocation=(), microphone=(), camera=()

# Session Security
# Cookie security settings (set COOKIE_SECURE=true in production with HTTPS)
COOKIE_SECURE=false
COOKIE_SAMESITE=Lax

# Session fingerprinting to detect token theft (default: true)
SESSION_FINGERPRINT_ENABLED=true
SESSION_DETECT_REUSE=true

# Input Validation
# Maximum request body size in bytes (default: 1MB)
MAX_REQUEST_BODY_SIZE=1048576

# Strict email validation using RFC 5322 compliance (default: true)
STRICT_EMAIL_VALIDATION=true

# Block known disposable email domains (default: false)
BLOCK_DISPOSABLE_EMAIL=false

# Multi-Factor Authentication (MFA/2FA)
# Enable TOTP-based two-factor authentication (default: true)
MFA_ENABLED=true

# MFA encryption key for storing TOTP secrets (REQUIRED if MFA_ENABLED=true)
# Generate with: openssl rand -hex 32
# Must be a 64-character hexadecimal string (32 bytes)
MFA_ENCRYPTION_KEY=

# =============================================================================
# PRODUCTION RECOMMENDATIONS
# =============================================================================
# For production deployments, consider these settings:
#
# Rate Limiting:
#   RATE_LIMIT_ENABLED=true (keep enabled)
#
# Password Policy (enforce strong passwords):
#   PASSWORD_MIN_LENGTH=12
#   PASSWORD_REQUIRE_UPPERCASE=true
#   PASSWORD_REQUIRE_LOWERCASE=true
#   PASSWORD_REQUIRE_NUMBER=true
#   PASSWORD_REQUIRE_SPECIAL=true
#
# Security Headers:
#   SECURITY_HEADERS_ENABLED=true (keep enabled)
#
# Session Security (IMPORTANT):
#   COOKIE_SECURE=true (requires HTTPS)
#   COOKIE_SAMESITE=Strict
#   SESSION_FINGERPRINT_ENABLED=true
#   SESSION_DETECT_REUSE=true
#
# Input Validation:
#   STRICT_EMAIL_VALIDATION=true
#   BLOCK_DISPOSABLE_EMAIL=true (if you want to block temporary emails)
#
# MFA Configuration:
#   MFA_ENABLED=true (keep enabled for additional security)
#   MFA_ENCRYPTION_KEY=<generate with: openssl rand -hex 32>
# =============================================================================
